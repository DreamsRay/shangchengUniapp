(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/cart/cart"],{"21d9":function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=a(n("4795"));function a(t){return t&&t.__esModule?t:{default:t}}function c(t,e,n,o,a,c,r){try{var i=t[c](r),u=i.value}catch(s){return void n(s)}i.done?e(u):Promise.resolve(u).then(o,a)}function r(t){return function(){var e=this,n=arguments;return new Promise((function(o,a){var r=t.apply(e,n);function i(t){c(r,o,a,i,u,"next",t)}function u(t){c(r,o,a,i,u,"throw",t)}i(void 0)}))}}var i=function(){n.e("components/lc-number-box/lc-numberBox").then(function(){return resolve(n("3cd8"))}.bind(null,n)).catch(n.oe)},u=function(){n.e("components/uni-number-box/uni-number-box").then(function(){return resolve(n("dc48"))}.bind(null,n)).catch(n.oe)},s={components:{lcNumberBox:i,uniNumberBox:u},data:function(){return{address:null,total:0,discount:"",allChecked:!1,empty:!1,cartList:[],orderGoods:[]}},onShow:function(){this.loadData()},watch:{cartList:function(t){this.empty=0===t.length}},computed:{orderCheck:function(){return 0===this.orderGoods.length}},methods:{changeGoods:function(){var t=[];this.cartList.forEach((function(e){1==e.checked&&t.push(e.id)})),this.orderGoods=t,console.log(this.orderGoods)},loadData:function(){var t=this;return r(o.default.mark((function e(){var n,a;return o.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.$api.account.getMyCart();case 2:return n=e.sent,a=n.map((function(e){return e.checked=!0,t.orderGoods.push(e.id),e})),e.next=6,t.$api.account.getProfile().then((function(e){t.address=e[0].default_address}));case 6:t.cartList=a,t.calcTotal();case 8:case"end":return e.stop()}}),e)})))()},onImageLoad:function(t,e){this.$set(this[t][e],"loaded","loaded")},onImageError:function(t,e){this[t][e].image="/static/errorImage.jpg"},navToAddress:function(){t.navigateTo({url:"/pages/address/addressManager"})},check:function(t,e){if("item"===t)this.cartList[e].checked=!this.cartList[e].checked;else{var n=!this.allChecked,o=this.cartList;o.forEach((function(t){t.checked=n})),this.allChecked=n}this.changeGoods(),this.calcTotal(t)},changeMyCarts:function(e,n){var o=this;this.$api.account.editMyCart(n.goods_id,e).then((function(n){o.loadData(),e==n.goods.stock&&t.showToast({title:"库存不足",duration:2e3})}))},deleteCartItem:function(e){var n=this;this.$api.account.editMyCart(this.cartList[e].goods_id,0).then((function(t){n.loadData()})),t.hideLoading()},clearCart:function(){this.cartList.forEach((function(t){t.checked=!1}))},calcTotal:function(){var t=this.cartList;if(0!==t.length){var e=0,n=0,o=!0;t.forEach((function(t){!0===t.checked?(e+=t.goods.price*t.amount,n+=t.goods.fake_price*t.amount):!0===o&&(o=!1)})),this.allChecked=o,this.total=Number(e.toFixed(2)),this.discount=Number(n.toFixed(2))-this.total}else this.empty=!0},order:function(){var e=this;this.$api.account.createOrder(this.orderGoods).then((function(n){n.success?t.navigateTo({url:"/pages/order/orderDetail?id="+n.order}):e.$api.msg(n.msg)}))}}};e.default=s}).call(this,n("543d")["default"])},"2a47":function(t,e,n){"use strict";n.r(e);var o=n("21d9"),a=n.n(o);for(var c in o)"default"!==c&&function(t){n.d(e,t,(function(){return o[t]}))}(c);e["default"]=a.a},"5c14":function(t,e,n){"use strict";n.r(e);var o=n("df0c"),a=n("2a47");for(var c in a)"default"!==c&&function(t){n.d(e,t,(function(){return a[t]}))}(c);n("f3e0");var r,i=n("f0c5"),u=Object(i["a"])(a["default"],o["b"],o["c"],!1,null,null,null,!1,o["a"],r);e["default"]=u.exports},a28e:function(t,e,n){},b321:function(t,e,n){"use strict";(function(t){n("aead"),n("921b");o(n("66fd"));var e=o(n("5c14"));function o(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,n("543d")["createPage"])},df0c:function(t,e,n){"use strict";var o,a=function(){var t=this,e=t.$createElement,n=(t._self._c,t.discount.toFixed(2));t.$mp.data=Object.assign({},{$root:{g0:n}})},c=[];n.d(e,"b",(function(){return a})),n.d(e,"c",(function(){return c})),n.d(e,"a",(function(){return o}))},f3e0:function(t,e,n){"use strict";var o=n("a28e"),a=n.n(o);a.a}},[["b321","common/runtime","common/vendor"]]]);